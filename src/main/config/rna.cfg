executor.queueSize = 500
process.executor = 'uge'
process.penv = 'def_slot'
process.errorStrategy = 'retry'
process.maxRetries = 2

params { 
    
    genome_lib_dir = 'SRC_DIR/database/RNA/GRCh38_gc_gencode_v37_CTAT_lib_Mar012021/ctat_genome_lib_build_dir/ref_genome.fa.star.idx'

    sleep_time = '10s'

    //fastqc
    fastqc_enable = true
    fastqc_option = '--nogroup'
    per_page = '8'

    //star

    star_option = '--outSAMstrandField intronMotif \
                   --outSAMunmapped Within \
                   --alignMatesGapMax 500000 \
                   --alignIntronMax 500000 \
                   --alignSJstitchMismatchNmax -1 -1 -1 -1 \
                   --outSJfilterDistToOtherSJmin 0 0 0 0 \
                   --outSJfilterOverhangMin 12 12 12 12 \
                   --outSJfilterCountUniqueMin 1 1 1 1 \
                   --outSJfilterCountTotalMin 1 1 1 1 \
                   --chimSegmentMin 12 \
                   --chimJunctionOverhangMin 12 \
                   --chimOutType Junctions \
                   --chimOutJunctionFormat 1 \
                   --readFilesCommand gunzip -c \
                   --runThreadN 8 \
                   --outSAMtype BAM Unsorted'

    //parabricks star fusion
    star_fusion_enable = true

    //samtools sort
    expression_analysis_enable = true

    //htseq
    gtf_file = 'SRC_DIR/database/RNA/GRCh38_gencode_v37_CTAT_lib_Mar012021.plug-n-play/ctat_genome_lib_build_dir/ref_annot.gtf'

    //deseq2
    geneset = 'SRC_DIR/database/RNA/geneset'
    pseudo_count = 'True,1,20'
}

process  {

    withName: fastqc_check {
    cpus = 1
    maxForks = 100
    clusterOptions = '-S /bin/bash   -l s_vmem=7G  '
    }

    withName: make_fastqc_list {
    cpus = 1
    maxForks = 1
    clusterOptions = '-S /bin/bash   -l s_vmem=5G  '
    }

    withName: star {
    cpus = 8
    maxForks = 20
    clusterOptions = '-S /bin/bash  -l s_vmem=5G'
    }

    withName: star_fusion {
    cpus = 1
    maxForks = 100
    clusterOptions = '-S /bin/bash -l s_vmem=16G '
    }

    withName: htseq {
    cpus = 1
    maxForks = 100
    clusterOptions = '-S /bin/bash  -l s_vmem=16G'
    }

    withName: deseq2 {
    cpus = 1
    maxForks = 100
    clusterOptions = '-S /bin/bash  -l s_vmem=16G'
    }
}
